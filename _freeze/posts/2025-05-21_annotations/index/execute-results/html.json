{
  "hash": "bfd7fc4bd13a746dc4d1d88a821f4074",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"selective annotations\"\nformat: html\nauthor: Jen Richmond\ndate: 2025-05-23\ncode-fold: show\n---\n\nMy friend Lisa called me with a ggplot challenge the other day. She was trying to work out how to have only some of her points labelled with annotations. Here are some notes about how you can label some points but not others. \n\n### load packages/make dataframe\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\n## make up some data\n\ndf <- data.frame(\n             level = as.factor(c(\"Level A\", \"Level A\", \n                                 \"Level B\", \"Level B\", \n                                 \"Level C\", \"Level C\", \n                                 \"Level D\", \"Level D\",\n                                 \"Level E\", \"Level E\")),\n              gender = as.factor(c(\"Female\",\"Male\",\n                                   \"Female\",\"Male\",\n                                   \"Female\",\"Male\",\n                                   \"Female\",\"Male\", \n                                   \"Female\",\"Male\")),\n             score = c(12L, 23L, 13L, 20L, 16L, 18L, 15L, 20L, 11L, 22L)\n      )\n\nglimpse(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 10\nColumns: 3\n$ level  <fct> Level A, Level A, Level B, Level B, Level C, Level C, Level D, …\n$ gender <fct> Female, Male, Female, Male, Female, Male, Female, Male, Female,…\n$ score  <int> 12, 23, 13, 20, 16, 18, 15, 20, 11, 22\n```\n\n\n:::\n:::\n\n\n# data setup \n\nFirst, check that levels are behaving and then create new variables that contain just the values you want to print on your plot. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlevels(df$level)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Level A\" \"Level B\" \"Level C\" \"Level D\" \"Level E\"\n```\n\n\n:::\n\n```{.r .cell-code}\ndf <- df %>%\n  mutate(f_values = case_when(gender == \"Female\" ~ score), \n         m_values = case_when(gender == \"Male\" ~ score)) \n\nglimpse(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 10\nColumns: 5\n$ level    <fct> Level A, Level A, Level B, Level B, Level C, Level C, Level D…\n$ gender   <fct> Female, Male, Female, Male, Female, Male, Female, Male, Femal…\n$ score    <int> 12, 23, 13, 20, 16, 18, 15, 20, 11, 22\n$ f_values <int> 12, NA, 13, NA, 16, NA, 15, NA, 11, NA\n$ m_values <int> NA, 23, NA, 20, NA, 18, NA, 20, NA, 22\n```\n\n\n:::\n:::\n\n\n\n# basic plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf %>%\n  ggplot(aes(x = level, y = score, \n             colour = gender, group = gender)) +\n  geom_point() + \n  geom_line() +\n  scale_y_continuous(limits = c(0,30)) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n# plot with selective annotations\n\nHere we have added two `geom_text()` calls, one for m_values and one for f_values. Unfortunately the values end up on top of the points.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf %>%\n  ggplot(aes(x = level, y = score, \n             colour = gender, group = gender)) +\n  geom_point() + \n  geom_line() +\n  scale_y_continuous(limits = c(0,30)) +\n  theme_minimal() +\n  geom_text(aes(label = m_values), size = 3) +\n  geom_text(aes(label = f_values), size = 3) \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nAdd a little vjust to shift the points up and down a little from the points. Don't love what has happened to the legend though...\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf %>%\n  ggplot(aes(x = level, y = score, \n             colour = gender, group = gender)) +\n  geom_point() + \n  geom_line() +\n  scale_y_continuous(limits = c(0,30)) +\n  theme_minimal() +\n  geom_text(aes(label = m_values), vjust = -2, size = 3) +\n  geom_text(aes(label = f_values), vjust = 2, size = 3) \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\nAdding show.legend = FALSE to let R know that I don't want the text labels to appear in the legend. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf %>%\n  ggplot(aes(x = level, y = score, colour = gender, group = gender)) +\n  geom_point() + \n  geom_line() +\n  scale_y_continuous(limits = c(0,30)) +\n  theme_minimal() +\n  geom_text(aes(label = m_values), vjust = -2, size = 3, show.legend = FALSE) +\n  geom_text(aes(label = f_values), vjust = 2, size = 3, show.legend = FALSE) \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\nSUCCESS!\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}