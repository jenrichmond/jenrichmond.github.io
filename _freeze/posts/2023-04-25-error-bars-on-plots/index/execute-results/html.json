{
  "hash": "35055e02b04c106f77b94c14c1d16252",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: error bars on plots\ndate: '2023-04-25'\nauthor:\n  - name: Jen Richmond\n    url: https://jenrichmond.github.io/\nformat: html\neditor: source\ndraft: FALSE\nimage: featured.png\ncategories: \n- idhgt\n- ggplot\n---\n\n\n\nRepurposing this APA figures post as a IDHTG (I don't have to google) post. \n\nAs I write my first paper reporting data analysis coming out of R (woot!!!), here are some notes summarising all the googling I have done this morning about how to produce APA style figures in ggplot. \n\n\n### Load libraries\nStart by loading `tidyverse` to get ggplot, `here` to make finding the data easy, and `papaja` to get the theme_apa() function. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.4     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(here)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nhere() starts at /Users/jenrichmond/Dropbox/ALL_R_stuff/2. WEBSITES/jenrichmond.github.io\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(papaja)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: tinylabels\n```\n\n\n:::\n:::\n\n\n\n\n### Read in data\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplotdata <- read_csv(\"plotdata.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNew names:\nRows: 8 Columns: 9\n── Column specification\n──────────────────────────────────────────────────────── Delimiter: \",\" chr\n(4): direction, group, detailtype, groupnew dbl (5): ...1, mean, stdev, n,\nstderr\nℹ Use `spec()` to retrieve the full column specification for this data. ℹ\nSpecify the column types or set `show_col_types = FALSE` to quiet this message.\n• `` -> `...1`\n```\n\n\n:::\n\n```{.r .cell-code}\nhead(plotdata)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 9\n   ...1 direction group     detailtype  mean stdev     n stderr groupnew       \n  <dbl> <chr>     <chr>     <chr>      <dbl> <dbl> <dbl>  <dbl> <chr>          \n1     1 future    control   episodic    9.46  4.04    28  0.764 control group  \n2     2 future    control   semantic    4.57  2.35    28  0.444 control group  \n3     3 future    induction episodic    9.38  3.62    29  0.672 induction group\n4     4 future    induction semantic    4.69  2.85    29  0.530 induction group\n5     5 past      control   episodic   11.2   6.67    28  1.26  control group  \n6     6 past      control   semantic    5.5   5.53    28  1.05  control group  \n```\n\n\n:::\n:::\n\n\n\n\n\n# Basic ggplot (columns)\nPlot separate bars for episodic vs semantic details, by past and future events, separately for kids in the control group vs. induction group. Get pairs of columns using position = \"dodge\". \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplotdata %>%\n  ggplot(aes(x= detailtype, y = mean, fill = direction)) +\n    geom_col(position = \"dodge\") +\n  facet_wrap(~ groupnew)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\n\n### Add error bars\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplotdata %>%\n  ggplot(aes(x= detailtype, y = mean, fill = direction)) +\n    geom_col(position = \"dodge\") +\n  facet_wrap(~ groupnew) + geom_errorbar(aes(ymin=mean-stderr, ymax=mean+stderr),\n                  size=.3,    # Thinner lines\n                    width=.2,\n                      position=position_dodge(.9))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\n\n### APA-ise\nThe theme_apa() from the pajaja package does most of the APAising. Gets rid of the grey and gridlines. But for some reason, now the bars are floating. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplotdata %>%\n  ggplot(aes(x= detailtype, y = mean, fill = direction)) +\n    geom_col(position = \"dodge\") +\n  facet_wrap(~ groupnew) + geom_errorbar(aes(ymin=mean-stderr, ymax=mean+stderr),\n                  size=.3,    # Thinner lines\n                    width=.2,\n                      position=position_dodge(.9)) +\n  theme_apa(base_size = 14)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n\n\n### Fix x and y axis\nExtend y axis scale and make the bars sit on the x axis\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplotdata %>%\n  ggplot(aes(x= detailtype, y = mean, fill = direction)) +\n    geom_col(position = \"dodge\") +\n  facet_wrap(~ groupnew) + geom_errorbar(aes(ymin=mean-stderr, ymax=mean+stderr),\n                  size=.3,    # Thinner lines\n                    width=.2,\n                      position=position_dodge(.9)) +\n  theme_apa(base_size = 14) +\n  scale_y_continuous(expand = c(0, 0), limits = c(0, 15)) # expand 0,0 to make the bars sit down\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\n\n### Fix axis labels\n\nUse the `\\n` notation to break a label or title across two lines\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplotdata %>%\n  ggplot(aes(x= detailtype, y = mean, fill = direction)) +\n    geom_col(position = \"dodge\") +\n  facet_wrap(~ groupnew) + geom_errorbar(aes(ymin=mean-stderr, ymax=mean+stderr),\n                  size=.3,    # Thinner lines\n                    width=.2,\n                      position=position_dodge(.9)) +\n  theme_apa(base_size = 14) +\n  scale_y_continuous(expand = c(0, 0), limits = c(0, 15)) +\n   labs(x=\"Detail type\", y=\"Mean number of details \\n produced\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\n\n### Make grey scale\n\nUse scale_fill_grey(), values 1 = white and 0 = black, specify values in between to get shades of grey \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplotdata %>%\n  ggplot(aes(x= detailtype, y = mean, fill = direction)) +\n    geom_col(position = \"dodge\") +\n  facet_wrap(~ groupnew) + geom_errorbar(aes(ymin=mean-stderr, ymax=mean+stderr),\n                  size=.3,    # Thinner lines\n                    width=.2,\n                      position=position_dodge(.9)) +\n  theme_apa(base_size = 14) +\n  scale_y_continuous(expand = c(0, 0), limits = c(0, 15)) +\n   labs(x=\"Detail type\", y=\"Mean number of details \\n produced\") +\n  scale_fill_grey(start = 0.40, end = 0.6) \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n\n### Save as png to add to your paper\n\nUse ggsave(\"nameoffile.png\") to save the last plot as png. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggsave(\"featured.png\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nSaving 7 x 5 in image\n```\n\n\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}