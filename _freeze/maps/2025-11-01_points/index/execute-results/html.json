{
  "hash": "0874d4ae32e2f0442376bbc3f00c113b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Day 1: points\"\nauthor: Jen Richmond\ndate: 2025-11-01\nformat: html\neditor: source\ndraft: FALSE\nimage: gw.png\nexecute:\n  freeze: true\n---\n\nI am supposed to be hiking the Routeburn Track next week (if the [waist-deep snow melts](https://www.facebook.com/share/p/1ZFTkXT3Kn/) and the Harris Saddle is open) so thought I would start the #30DayMapChallenge with some data about New Zealand Great Walks. \n\n![](gw.png)\n\n\n# read data\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(googlesheets4)\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(rnaturalearth)\nlibrary(ggeasy)\nlibrary(ggsci)\n\nbookings <- read_sheet(\"https://docs.google.com/spreadsheets/d/1v3ZIwjE3RgQ3y0seRQ1EAg1xj1VN0oVUHjGKm_-6bRY/edit?gid=0#gid=0\", sheet = \"gw_bookings\") %>%\nselect(-\"Total all Great Walks\") %>%\n  pivot_longer(names_to = \"track\", values_to = \"count\", \"Abel Tasman Coast Track\":\"Whanganui Journey\") \n\n\ntracks <- read_sheet(\"https://docs.google.com/spreadsheets/d/1v3ZIwjE3RgQ3y0seRQ1EAg1xj1VN0oVUHjGKm_-6bRY/edit?gid=0#gid=0\", sheet = \"gw_lat_long\") %>%\n  clean_names() \n```\n:::\n\n\n## wrangle data\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ntracks <- tracks %>%\n separate(start_lat_long, into = c(\"start_lat\", \"start_long\"), \",\") %>%\n  separate(end_lat_long, into = c(\"end_lat\", \"end_long\"), \",\") %>%\nmutate(track_format = stringr::str_extract(location, \"\\\\([^)]+\\\\)$\"), # extract string within last bracket\n                track_format = stringr::str_remove_all(track_format, \"[\\\\(\\\\)]\"),  # remove brackets\n                location = stringr::str_remove(location, \"\\\\s*\\\\([^)]+\\\\)$\")) %>% # make everything but the bracket content location\n  mutate(start_location = str_extract(location, \"^[^:]+\"), # pull up to first : into start location\n         end_location = str_extract(location, \"(?<=;\\\\s)[^:]+\")) %>% # pull text after ; space up to :\nmutate(start_lat = as.numeric(start_lat), end_lat = as.numeric(end_lat), \n       start_long = as.numeric(start_long), end_long = as.numeric(end_long))\n  \n\njoined <- left_join(bookings, tracks, by = \"track\")\n\ntotal_year <- joined %>%\n  group_by(year, track, start_lat, start_long, track_format) %>%\n  summarise(total_bookings = sum(count))\n\ntotal23_24 <- total_year %>%\n  filter(year == \"2023-2024\") %>%\n  mutate(booking_category = cut(total_bookings, \n                                 breaks = c(0, 5000, 10000, Inf),\n                                 labels = c(\"Low (0-5k)\", \"Medium (5-10k)\", \"High (>10k)\"))) %>%\n  mutate(track_format = fct_relevel(track_format, c(\"one way\", \"river journey\", \"loop track\")))\n```\n:::\n\n\n## plot data\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nnz <- ne_countries(country = \"new zealand\", returnclass = \"sf\", scale = \"large\")\n\n# first plot from tracks data to check locations, includes all 11 tracks\n\nggplot() +\n  geom_sf(data = nz) +\n  geom_point(data = tracks, aes(x = start_long, y = start_lat, colour = track), size = 2) +\n  coord_sf(xlim = c(166, 179), ylim = c(-47, -34)) +\n  theme_minimal() +\n easy_remove_axes(which = c(\"both\"), what = c(\"title\")) +\n  labs(title = \"Where are the Great Walks of New Zealand?\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code  code-fold=\"true\"}\n# then plot from 23-24 season from bookings joined data, only have booking data for 9 tracks\n\n\nggplot() +\n  geom_sf(data = nz) +\n  geom_point(data = total23_24, aes(x = start_long, y = start_lat, \n                                    colour = track_format, size = booking_category), shape = 20) +\n  coord_sf(xlim = c(166, 179), ylim = c(-47, -34)) +\n  theme_bw()  +\n  scale_size_manual(values = c(3, 5, 7), name = \"Visitors\") +\n   easy_remove_axes(which = c(\"both\"), what = c(\"title\")) + \n  scale_color_npg() +\n  easy_add_legend_title(\"Track type\") +\n  guides(color = guide_legend(override.aes = list(size = 3))) + # Larger dots in the legend\n  labs(title = \"Which New Zealand Great Walk had the most traffic in the 2023-2024 season?\", \n       subtitle = \"There are 11 Great Walks in New Zealand. More than 14000 people walked the \\nAbel Tasman Coast track in the 2023-2024 season. Tracks in Fiordland were also popular. \\nThe Routeburn and Kepler tracks each saw between 6000 and 7000 visitors.\", \n       caption = \"Note: Visitor numbers for the Hump Ridge track and the \\nLake Waikaremoana track were unavailable.\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n:::\n\n\n\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}