{
  "hash": "7d122e6e6a2462576c9afee88df3f66b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"day 16_negative\"\nauthor:\n  - name: Jen Richmond\n    url: https://jenrichmond.github.io/\ndate: 2025-04-16\nformat: html\neditor: source\nimage: featured.png\nexecute:\n  freeze: true\n---\n\n\n\n\nExploring OurWorldinData this morning looking for plots that might fit the negative theme for today and [this article](https://ourworldind%20ata.org/collective-pessimism-and-our-inability-to-guess-the-happiness-of-others) caught my eye.\n\n![](happiness-of-others.png){fig-align=\"center\" width=\"6in\"}\n\nApparently we vastly underestimate how happy other people are. Much like my [Day 1 plot re climate action](https://jenrichmond.github.io/charts/2025-04-01_fractions/), when asked how happy they are and how happy they think other people in their country are, we judge others negatively, rating them to be much less happy than we are ourselves.\n\nSadly I couldn't find the data from that plot to reproduce it, but in exploring the IPSOS website, I found [this article](https://www.ipsos.com/en/global-opinion-polls/right-direction-or-wrong-track) about what worries the world in March 2025. The data was downloadable and I think probably better represented as stacked bars rather than pie charts, so that is my challenge for today.\n\n## get the data\n\nHere I am reading the data from csv and making it into long format.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(here)\nlibrary(janitor)\nlibrary(ggeasy)\nlibrary(plotly)\n\nright_wrong <- read_csv(here(\"charts\", \"2025-04-16_negative\", \"ipsos_direction.csv\")) %>%\n  rename(track = Country) \n\n\nright_wrong_long <- right_wrong %>%\n  pivot_longer(names_to = \"country\", values_to = \"percent\", World:Peru) %>%\n  arrange(country, track) \n\nglimpse(right_wrong_long)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 60\nColumns: 3\n$ track   <chr> \"Right Track\", \"Wrong Track\", \"Right Track\", \"Wrong Track\", \"R…\n$ country <chr> \"Argentina\", \"Argentina\", \"Australia\", \"Australia\", \"Belgium\",…\n$ percent <dbl> 59, 41, 48, 52, 36, 64, 35, 65, 31, 69, 27, 73, 33, 67, 15, 58…\n```\n\n\n:::\n:::\n\n\n\n\n## plot\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nright_wrong_long %>%\n  ggplot(aes(x = country, y = percent, fill = track)) +\n  geom_col() +\n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n\nBasic plot check! Things I would like to change...\n\n-   something weird is going on with France, that is obviously a data entry error- exclude France\n-   I would like to order the bars from highest right track to lowest\n-   fix the theme and colours, add titles and data annotations\n\n### bar order\n\nI need to turn country into a factor based on the percent values highest to lowest, but I am not sure how to do that with the data long, because for some countries the max percent value is the Right Track and for other countries the max is the Wrong Track value.\n\nMaybe I need to make the data wide, with Right and Wrong track in separate columns first??\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nright_wrong_wide <- right_wrong_long %>%\n  pivot_wider(names_from = track, values_from = percent) %>%\n  clean_names()\n\nglimpse(right_wrong_wide)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 30\nColumns: 3\n$ country     <chr> \"Argentina\", \"Australia\", \"Belgium\", \"Brazil\", \"Canada\", \"…\n$ right_track <dbl> 59, 48, 36, 35, 31, 27, 33, 15, 21, 29, 23, 62, 63, 31, 28…\n$ wrong_track <dbl> 41, 52, 64, 65, 69, 73, 67, 58, 79, 71, 77, 38, 37, 69, 72…\n```\n\n\n:::\n:::\n\n\n\n\nNow R thinks that country is characters so lets make it a factor with the levels based on values of right track.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nright_wrong_wide <- right_wrong_wide %>%\n  mutate(country = fct_reorder(country, right_track)) \n\nlevels(right_wrong_wide$country)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"Peru\"          \"France\"        \"South Korea\"   \"Germany\"      \n [5] \"Japan\"         \"Hungary\"       \"Türkiye\"       \"Chile\"        \n [9] \"Netherlands\"   \"Sweden\"        \"Italy\"         \"South Africa\" \n[13] \"Great Britain\" \"Canada\"        \"Israel\"        \"Spain\"        \n[17] \"Colombia\"      \"Brazil\"        \"Belgium\"       \"World\"        \n[21] \"Poland\"        \"US\"            \"Australia\"     \"Thailand\"     \n[25] \"Mexico\"        \"Argentina\"     \"India\"         \"Indonesia\"    \n[29] \"Malaysia\"      \"Singapore\"    \n```\n\n\n:::\n:::\n\n\n\n\nGreat! Peru has the lowest value and Singapore has the highest value. Now what happens to the country factor when I make the data long again? Does the order stick around??\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nright_wrong_long_new <- right_wrong_wide %>%\n  pivot_longer(names_to = \"track\", values_to = \"percent\", right_track:wrong_track) \n\nlevels(right_wrong_long_new$country)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"Peru\"          \"France\"        \"South Korea\"   \"Germany\"      \n [5] \"Japan\"         \"Hungary\"       \"Türkiye\"       \"Chile\"        \n [9] \"Netherlands\"   \"Sweden\"        \"Italy\"         \"South Africa\" \n[13] \"Great Britain\" \"Canada\"        \"Israel\"        \"Spain\"        \n[17] \"Colombia\"      \"Brazil\"        \"Belgium\"       \"World\"        \n[21] \"Poland\"        \"US\"            \"Australia\"     \"Thailand\"     \n[25] \"Mexico\"        \"Argentina\"     \"India\"         \"Indonesia\"    \n[29] \"Malaysia\"      \"Singapore\"    \n```\n\n\n:::\n:::\n\n\n\n\nSUCCESS!!\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nright_wrong_long_new <- right_wrong_long_new %>%\n  mutate(track = fct_relevel(track, c(\"wrong_track\", \"right_track\")))\n\n\n\nlevels(right_wrong_long_new$track)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"wrong_track\" \"right_track\"\n```\n\n\n:::\n:::\n\n\n\n\n### replot with new order\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nright_wrong_long_new %>%\n  filter(country != \"France\") %>%\n  ggplot(aes(x = country, y = percent, fill = track)) +\n  geom_col() +\n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\n### colours etc\n\nI learned a few things about legend control here. I didn't know previously that you could change the legend title and labels within the scale_fill_manual() function. I also used `guides(fill = guide_legend(reverse = TRUE)` to reverse the order of the legend display (so that Right appeared above Wrong), even when that order was the opposite of the factor levels. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npalette <- c (\"#e94554\", \"#009d9c\")\n\np <- right_wrong_long_new %>%\n  filter(country != \"France\") %>%\n  ggplot(aes(x = country, y = percent, fill = track)) +\n  scale_fill_manual(values = palette, name = \"Direction\", labels = c(\"Wrong\", \"Right\")) +\n  geom_col() +\n  coord_flip() +\n  theme_minimal() +\n  easy_remove_gridlines() +\n  scale_y_continuous(expand = c(0,0)) +\n  labs(y = \"Country\", x = \"Percent of people\", \n       title = \"Percent of the public who rate their country as heading in \\nright direction vs the wrong direction\", \n       caption = \"Source: Ipsos: What Worries The World? March 2025 • \\nBase: Representative sample of 25,746 adults aged 16-74 in 29 participating countries, \\nFebruary 21 2025 - March 7 2025.\") +\n  guides(fill = guide_legend(reverse = TRUE))\n  \np\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n## add interactive with plotly \n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-cc1715c35295eefa6eea\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-cc1715c35295eefa6eea\">{\"x\":{\"data\":[{\"orientation\":\"h\",\"width\":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000036,0.89999999999999858,0.90000000000000036,0.89999999999999858,0.90000000000000036,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000036,0.89999999999999858,0.89999999999999858,0.89999999999999947,0.89999999999999991,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000013,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000036,0.89999999999999858,0.89999999999999858],\"base\":[59,48,36,35,31,27,33,21,29,23,62,63,31,28,21,69,58,27,10,41,81,28,17,32,27,56,24,43,37],\"x\":[41,52,64,65,69,73,67,79,71,77,38,37,69,72,79,31,42,73,90,59,19,72,83,68,73,44,76,57,63],\"y\":[25,22,18,17,13,7,16,3,12,5,26,27,14,10,4,28,24,8,1,20,29,11,2,15,9,23,6,21,19],\"text\":[\"country: Argentina<br />percent: 41<br />track: wrong_track\",\"country: Australia<br />percent: 52<br />track: wrong_track\",\"country: Belgium<br />percent: 64<br />track: wrong_track\",\"country: Brazil<br />percent: 65<br />track: wrong_track\",\"country: Canada<br />percent: 69<br />track: wrong_track\",\"country: Chile<br />percent: 73<br />track: wrong_track\",\"country: Colombia<br />percent: 67<br />track: wrong_track\",\"country: Germany<br />percent: 79<br />track: wrong_track\",\"country: Great Britain<br />percent: 71<br />track: wrong_track\",\"country: Hungary<br />percent: 77<br />track: wrong_track\",\"country: India<br />percent: 38<br />track: wrong_track\",\"country: Indonesia<br />percent: 37<br />track: wrong_track\",\"country: Israel<br />percent: 69<br />track: wrong_track\",\"country: Italy<br />percent: 72<br />track: wrong_track\",\"country: Japan<br />percent: 79<br />track: wrong_track\",\"country: Malaysia<br />percent: 31<br />track: wrong_track\",\"country: Mexico<br />percent: 42<br />track: wrong_track\",\"country: Netherlands<br />percent: 73<br />track: wrong_track\",\"country: Peru<br />percent: 90<br />track: wrong_track\",\"country: Poland<br />percent: 59<br />track: wrong_track\",\"country: Singapore<br />percent: 19<br />track: wrong_track\",\"country: South Africa<br />percent: 72<br />track: wrong_track\",\"country: South Korea<br />percent: 83<br />track: wrong_track\",\"country: Spain<br />percent: 68<br />track: wrong_track\",\"country: Sweden<br />percent: 73<br />track: wrong_track\",\"country: Thailand<br />percent: 44<br />track: wrong_track\",\"country: Türkiye<br />percent: 76<br />track: wrong_track\",\"country: US<br />percent: 57<br />track: wrong_track\",\"country: World<br />percent: 63<br />track: wrong_track\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(233,69,84,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"wrong_track\",\"legendgroup\":\"wrong_track\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"h\",\"width\":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000036,0.89999999999999858,0.90000000000000036,0.89999999999999858,0.90000000000000036,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000036,0.89999999999999858,0.89999999999999858,0.89999999999999947,0.89999999999999991,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000013,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000036,0.89999999999999858,0.89999999999999858],\"base\":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\"x\":[59,48,36,35,31,27,33,21,29,23,62,63,31,28,21,69,58,27,10,41,81,28,17,32,27,56,24,43,37],\"y\":[25,22,18,17,13,7,16,3,12,5,26,27,14,10,4,28,24,8,1,20,29,11,2,15,9,23,6,21,19],\"text\":[\"country: Argentina<br />percent: 59<br />track: right_track\",\"country: Australia<br />percent: 48<br />track: right_track\",\"country: Belgium<br />percent: 36<br />track: right_track\",\"country: Brazil<br />percent: 35<br />track: right_track\",\"country: Canada<br />percent: 31<br />track: right_track\",\"country: Chile<br />percent: 27<br />track: right_track\",\"country: Colombia<br />percent: 33<br />track: right_track\",\"country: Germany<br />percent: 21<br />track: right_track\",\"country: Great Britain<br />percent: 29<br />track: right_track\",\"country: Hungary<br />percent: 23<br />track: right_track\",\"country: India<br />percent: 62<br />track: right_track\",\"country: Indonesia<br />percent: 63<br />track: right_track\",\"country: Israel<br />percent: 31<br />track: right_track\",\"country: Italy<br />percent: 28<br />track: right_track\",\"country: Japan<br />percent: 21<br />track: right_track\",\"country: Malaysia<br />percent: 69<br />track: right_track\",\"country: Mexico<br />percent: 58<br />track: right_track\",\"country: Netherlands<br />percent: 27<br />track: right_track\",\"country: Peru<br />percent: 10<br />track: right_track\",\"country: Poland<br />percent: 41<br />track: right_track\",\"country: Singapore<br />percent: 81<br />track: right_track\",\"country: South Africa<br />percent: 28<br />track: right_track\",\"country: South Korea<br />percent: 17<br />track: right_track\",\"country: Spain<br />percent: 32<br />track: right_track\",\"country: Sweden<br />percent: 27<br />track: right_track\",\"country: Thailand<br />percent: 56<br />track: right_track\",\"country: Türkiye<br />percent: 24<br />track: right_track\",\"country: US<br />percent: 43<br />track: right_track\",\"country: World<br />percent: 37<br />track: right_track\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,157,156,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"right_track\",\"legendgroup\":\"right_track\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":43.762557077625573,\"r\":7.3059360730593621,\"b\":40.182648401826498,\"l\":101.55251141552515},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Percent of the public who rate their country as heading in <br />right direction vs the wrong direction\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0,100],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"25\",\"50\",\"75\",\"100\"],\"tickvals\":[0,25,50,75,100],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"25\",\"50\",\"75\",\"100\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Country\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,29.600000000000001],\"tickmode\":\"array\",\"ticktext\":[\"Peru\",\"South Korea\",\"Germany\",\"Japan\",\"Hungary\",\"Türkiye\",\"Chile\",\"Netherlands\",\"Sweden\",\"Italy\",\"South Africa\",\"Great Britain\",\"Canada\",\"Israel\",\"Spain\",\"Colombia\",\"Brazil\",\"Belgium\",\"World\",\"Poland\",\"US\",\"Australia\",\"Thailand\",\"Mexico\",\"Argentina\",\"India\",\"Indonesia\",\"Malaysia\",\"Singapore\"],\"tickvals\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29],\"categoryorder\":\"array\",\"categoryarray\":[\"Peru\",\"South Korea\",\"Germany\",\"Japan\",\"Hungary\",\"Türkiye\",\"Chile\",\"Netherlands\",\"Sweden\",\"Italy\",\"South Africa\",\"Great Britain\",\"Canada\",\"Israel\",\"Spain\",\"Colombia\",\"Brazil\",\"Belgium\",\"World\",\"Poland\",\"US\",\"Australia\",\"Thailand\",\"Mexico\",\"Argentina\",\"India\",\"Indonesia\",\"Malaysia\",\"Singapore\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Percent of people\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"Direction\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"1b5b24e5deb0\":{\"x\":{},\"y\":{},\"fill\":{},\"type\":\"bar\"}},\"cur_data\":\"1b5b24e5deb0\",\"visdat\":{\"1b5b24e5deb0\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}