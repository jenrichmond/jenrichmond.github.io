{
  "hash": "891c84d80182d6528aa09ce625f6d775",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"day 25 measles risk\"\nauthor:\n - name: Jen Richmond\nurl: https://jenrichmond.github.io/\ndate: 2025-04-25\nformat: html\neditor: source\nimage: featured.png\nexecute:\n  freeze: true\n---\n\n\n\n\n\n\nFor the Day 25 prompt risk, I am going to try my hand at maps and reproduce the [CDC plots](https://www.cdc.gov/measles/data-research/index.html#cdc_data_surveillance_section_7-mmr-vaccine-coverage-for-kindergarteners-by-school-year-2009%e2%80%932024) relating to measles vaccination and cases in the US. \n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(here)\nlibrary(usmap)\nlibrary(janitor)\n\nvax <- read_csv(here(\"charts/2025-04-25_risk/kindy_vax _rates.csv\")) %>%\n  mutate(year = str_sub(school_year, 1,4)) %>%\n  select(state = geography, year, estimate_pct, categories) %>%\n  mutate(estimate_pct = parse_number(estimate_pct)) \n\ncases2425 <- read_csv(here(\"charts/2025-04-25_risk/cases20242025.csv\")) %>%\n  select(state = geography, year, cases_calendar_year)\n\nvax$year <- as.numeric(vax$year)\n\nglimpse(vax)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 769\nColumns: 4\n$ state        <chr> \"Alabama\", \"Alaska\", \"Arizona\", \"Arkansas\", \"California\",…\n$ year         <dbl> 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 202…\n$ estimate_pct <dbl> 93.8, 84.3, 89.3, 92.5, 96.2, 88.3, 97.7, 93.8, 92.0, 88.…\n$ categories   <chr> \"90-94.9%\", \"Less than 90%\", \"Less than 90%\", \"90-94.9%\",…\n```\n\n\n:::\n:::\n\n\n\n\n# vaccination rates\n\nIt looks like there is data for the school year going back to 2009- maybe that would be cool to animate later but for the moment I am interested in the most recent school year. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvax2324 <- vax %>%\n  filter(year == \"2023\") \n```\n:::\n\n\n\n\nThe dataset has vax rates as both percent estimate and categories. First I am going to try colouring by the numeric percent values. I would like the lowest to show up red. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmin(vax2324$estimate_pct)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 79.6\n```\n\n\n:::\n\n```{.r .cell-code}\nmax(vax2324$estimate_pct)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 98.3\n```\n\n\n:::\n\n```{.r .cell-code}\nplot_usmap(data = vax2324, values = \"estimate_pct\", labels=FALSE) +\n  scale_fill_continuous(low = \"red\", high = \"white\", \n                         name = \"percent\", \n                        limits = c(75,100)) +\n  labs(title = \"Percent of kindergarten children vaccinated for measles by state\", \n       subtitle = \"School year 2023-24\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\nWhat would it look like if we used the categories instead? \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvax2324$categories <- fct_relevel(vax2324$categories, c(\"95%+\", \"90-94.9%\", \"Less than 90%\"))\n\nlevels(vax2324$categories)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"95%+\"          \"90-94.9%\"      \"Less than 90%\"\n```\n\n\n:::\n\n```{.r .cell-code}\nplot_usmap(data = vax2324, values = \"categories\", labels=FALSE) +\n  scale_fill_manual(values = c(\"#ffcccc\", \"#ff7380\", \"#ff1933\"))  +\n   labs(title = \"Percent of kindergarten children vaccinated for measles by state\", \n       subtitle = \"School year 2023-24\") +\n  theme(\n    legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n### measles cases\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_usmap(data = cases2425, values = \"cases_calendar_year\", labels=FALSE) +\n  scale_fill_continuous(low = \"white\", high = \"red\", \n                         name = \"cases\", \n                        limits = c(0,600)) +\n  labs(title = \"USA Measles cases by state\", subtitle = \"Data as of April 17, 2025\", caption = \"Data from CDC \\nhttps://www.cdc.gov/measles/data-research/index.html\") +\n  facet_wrap(~ year) +\n  theme(\n    legend.position = \"bottom\",\n    strip.background = element_blank(),\n    strip.text = element_text(color = \"black\", size = 10)\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}