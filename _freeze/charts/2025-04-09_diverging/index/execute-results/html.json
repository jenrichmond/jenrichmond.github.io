{
  "hash": "810bab9824afee17612e5fc13fb10047",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"day 9_diverging\"\nauthor:\n  - name: Jen Richmond\n    url: https://jenrichmond.github.io/\ndate: 2025-04-09\nformat: html\neditor: source\nimage: featured.png\nexecute:\n  freeze: true\n---\n\n\n\n\n[Our World in Data](https://ourworldindata.org/happiness-and-life-satisfaction) has a series of plots that report data from the Integrated Values survey, asking people across the world how important they consider a range of life areas (family, friends,work, leisure time, politics, religion. For the Day 6 prompt, I am wondering whether our views on the relative importance of family and work have shifted over time. \n\n<iframe src=\"https://ourworldindata.org/grapher/how-important-family-is-to-people-in-life?tab=chart\" loading=\"lazy\" style=\"width: 100%; height: 600px; border: 0px none;\" allow=\"web-share; clipboard-write\"></iframe>\n\n\n### load packages\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(ggeasy)\nlibrary(RColorBrewer)\n```\n:::\n\n\n\n\n### read/combine data\n\nA bit of wrangling required for this one, because the data for each life area was in a different csv file. In this rather long code chunk, I am reading each csv in, cleaning up names, selecting relavant columns, adding a new column for life area, making the data long, and changing the string values in the ratings column to make them consistent (i.e. instead of very_important_in_life_family -> very_important_in_life). \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nfamily <- read_csv(\"https://ourworldindata.org/grapher/how-important-family-is-to-people-in-life.csv?v=1&csvType=full&useColumnShortNames=true\") %>%\n  clean_names() %>%\n  select(country = entity, year, ends_with(\"family\")) %>%\n  mutate(life_area = \"family\") %>%\n  pivot_longer(names_to = \"rating\", values_to = \"score\", very_important_in_life_family:no_answer_important_in_life_family) %>%\n  mutate(rating = str_sub(rating, 1, -8)) # edit string, start at pos1, end 8 chars back\n\nfriends <-  read_csv(\"https://ourworldindata.org/grapher/how-important-friends-are-to-people-in-life.csv?v=1&csvType=full&useColumnShortNames=true\") %>%\n  clean_names() %>%\n  select(country = entity, year, ends_with(\"friends\")) %>%\n  mutate(life_area = \"friends\") %>%\n  pivot_longer(names_to = \"rating\", values_to = \"score\", very_important_in_life_friends:no_answer_important_in_life_friends) %>%\n  mutate(rating = str_sub(rating, 1, -9)) \n  \nleisure <- read_csv(\"https://ourworldindata.org/grapher/how-important-leisure-is-to-people-in-life.csv?v=1&csvType=full&useColumnShortNames=true\") %>%\n  clean_names() %>%\n  select(country = entity, year, ends_with(\"leisure_time\")) %>%\n  mutate(life_area = \"leisure_time\") %>%\n  pivot_longer(names_to = \"rating\", values_to = \"score\", very_important_in_life_leisure_time:no_answer_important_in_life_leisure_time) %>%\n  mutate(rating = str_sub(rating, 1, -14)) \n  \npolitics <- read_csv(\"https://ourworldindata.org/grapher/how-important-politics-is-in-your-life.csv?v=1&csvType=full&useColumnShortNames=true\") %>%\n  clean_names() %>%\n  select(country = entity, year, ends_with(\"politics\")) %>%\n  mutate(life_area = \"politics\") %>%\n  pivot_longer(names_to = \"rating\", values_to = \"score\", very_important_in_life_politics:no_answer_important_in_life_politics) %>%\n  mutate(rating = str_sub(rating, 1, -10)) \n\nreligion <-read_csv(\"https://ourworldindata.org/grapher/how-important-religion-is-in-your-life.csv?v=1&csvType=full&useColumnShortNames=true\") %>%\n  clean_names() %>%\n  select(country = entity, year, ends_with(\"religion\")) %>%\n  mutate(life_area = \"religion\") %>%\n  pivot_longer(names_to = \"rating\", values_to = \"score\", very_important_in_life_religion:no_answer_important_in_life_religion) %>%\n  mutate(rating = str_sub(rating, 1, -10)) \n  \nwork <- read_csv(\"https://ourworldindata.org/grapher/how-important-work-is-to-people-in-life.csv?v=1&csvType=full&useColumnShortNames=true\") %>%\n  clean_names() %>%\n  select(country = entity, year, ends_with(\"work\")) %>%\n  mutate(life_area = \"work\") %>%\n  pivot_longer(names_to = \"rating\", values_to = \"score\", very_important_in_life_work:no_answer_important_in_life_work) %>%\n  mutate(rating = str_sub(rating, 1, -6)) \n```\n:::\n\n\n\n\nOnce I have separate dataframes for each life area that are all structured in the same way, I can use rbind() to join them all togeher. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlife <- rbind(family, friends, leisure, work, politics, religion)\n```\n:::\n\n\n\n\n### clean it up\n\nA little more string editing, this time chopping the _in_life piece of the end of each of the rating strings and converting both rating and life area to factors. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlife_ratings <- life %>%\n  mutate(rating = str_sub(rating, 1, -9)) %>%\n  mutate(rating = as_factor(rating)) %>%\n  mutate(life_area = as_factor(life_area))\n\nglimpse(life_ratings)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 14,328\nColumns: 5\n$ country   <chr> \"Albania\", \"Albania\", \"Albania\", \"Albania\", \"Albania\", \"Alba…\n$ year      <dbl> 1998, 1998, 1998, 1998, 1998, 1998, 2004, 2004, 2004, 2004, …\n$ life_area <fct> family, family, family, family, family, family, family, fami…\n$ rating    <fct> very_important, rather_important, not_very_important, notata…\n$ score     <dbl> 95.7958000, 3.2032030, 0.3003003, 0.2002002, 0.5005005, 0.00…\n```\n\n\n:::\n:::\n\n\n\n\nI am using the same selection of countries that I plotted in my sex ratio chart, for no good reason really. I am interested in just data for the family and work life areas and want to sum the proportion of people that have \"very important\" and \"rather important\" ratings so group the data by year, country and life area and sum the scores. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncountries <- c(\"China\", \"India\", \"South Korea\", \"Australia\", \"United States\", \"United Kingdom\")\nf_w <- c(\"family\", \"work\")\nimpt <- c(\"very_important\", \"rather_important\")\n\nwork_family <- life_ratings %>%\n  filter(life_area %in% f_w) %>%\n  filter(country %in% countries) %>%\n  filter(rating  %in% impt) %>%\n  group_by(year, country, life_area) %>%\n  summarise(important = sum(score)) %>%\n  ungroup()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'year', 'country'. You can override using\nthe `.groups` argument.\n```\n\n\n:::\n:::\n\n\n\n\n\n### plot family and work \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwork_family %>%\n  ggplot(aes(x = year, y = important, colour = life_area)) +\n  geom_point() +\n  geom_line() +\n  facet_wrap(~ country) +\n  labs(title = \"Percent of people who rate family and work as `very important` \\nor `rather important`\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\nBasic plot check! Things I would like to change...\n\n- theme and axis labels\n- scale issues\n- colour scheme\n- add subtitle caption\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwork_family %>%\n  ggplot(aes(x = year, y = important, colour = life_area)) +\n  geom_point(size = 2) +\n  geom_line() +\n  facet_wrap(~ country) +\n  labs(title = \"How important family and work are to people in life\", \n       subtitle = \"Share of survey respondents rating `very important` or `rather important`\", \n       x = \"Year\", y = \"Percent of people\", \n       caption = \"Data source: Integrated Values Surveys (2022)\") +\n  theme_minimal() +\n  scale_y_continuous(limits = c(70,100)) +\n  scale_x_continuous(limits = c(1990, 2022)) +\n  scale_color_brewer(palette = \"Set1\") +\n  easy_add_legend_title(\"Life Area\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}